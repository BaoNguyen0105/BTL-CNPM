<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../css/globals.css" />
    <link rel="stylesheet" href="../css/styleguide.css" />
    <link rel="stylesheet" href="../css/StudentProfile.css" />
  </head>
  <body>
    <div class="khai-thongtincanhan">
      <div class="top-bar">
        <div class="background"></div>
        <div class="logo"></div>
        <p class="name"><span class="text-wrapper">NGUYỄN VĂN A | </span> <span class="span">Sinh viên</span></p>
        <div class="div">Tutor System</div>
        <div class="text-wrapper-2">☰</div>
        <img class="bk-logo" src="../images/logo.png" />
      </div>
      <div class="frame">
        <div class="w-full h-[82px] bg-[#d9d9d9] flex flex-col sm:flex-row items-start sm:items-center justify-between px-4 sm:px-6 py-2 sm:py-0 gap-2 sm:gap-0">
          <span class="font-bold text-[16px] sm:text-[20px] text-black cursor-pointer">← Trở về trang trước</span>
          <div class="flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4">
            <span class="font-bold text-[14px] sm:text-[18px] lg:text-[20px] text-black whitespace-nowrap">Thời điểm cập nhật gần nhất: 29/10/2025 12:50:01</span>
            <span class="font-bold text-[16px] sm:text-[20px] underline text-black cursor-pointer" id="editInfoBtn">Chỉnh sửa thông tin</span>
          </div>
        </div>
      </div>
      <div class="side-bar">
        <div class="background-2"></div>
        <div class="row">
          <div class="text-wrapper-5">☰</div>
          <div class="text">Buổi học</div>
          <div class="text-wrapper-6">&gt;</div>
        </div>
        <div class="row-2">
          <div class="text-wrapper-5">☰</div>
          <div class="text">Thư viện</div>
          <div class="text-wrapper-6">&gt;</div>
        </div>
        <div class="row-3">
          <div class="text-wrapper-7">☰</div>
          <div class="text-2">Trang chủ</div>
          <div class="text-wrapper-8">&gt;</div>
        </div>
        <div class="row-4">
          <div class="text-3">Thông tin sinh viên</div>
          <div class="text-wrapper-9">&gt;</div>
          <div class="text-wrapper-10">☰</div>
        </div>
      </div>
      <div class="MAIN-CONTENT">
        <!-- Container chính với background #fbfafa -->
        <div class="w-full min-h-screen bg-[#fbfafa] p-4 sm:p-6">
          <!-- Section: Thông tin cá nhân -->
          <div class="w-full h-auto min-h-[65px] bg-[#3c8dbc] flex items-center px-4 sm:px-6 py-4 mb-4">
            <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-white">Thông tin cá nhân</span>
          </div>

          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6 mb-6">
            <!-- Cột 1: Chỉ có avatar -->
            <div class="flex items-start justify-center md:justify-start">
              <img class="w-full max-w-[166px] h-auto sm:h-[231px] object-cover rounded" src="../images/avatar.png" alt="Ảnh sinh viên" />
            </div>

            <!-- Cột 2: Thông tin cơ bản -->
            <div class="space-y-4">
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Họ và tên</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">Nguyễn Văn A</div>
              </div>
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Mã số sinh viên</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">22115001</div>
              </div>
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Khoa</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">Khoa Khoa học và Kỹ thuật Máy tính</div>
              </div>
            </div>

            <!-- Cột 3: Thông tin học tập -->
            <div class="space-y-4">
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Hệ đào tạo</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">Chính quy</div>
              </div>
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Chương trình</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">Chương trình Đại học tiêu chuẩn </div>
              </div>

            </div>

            <!-- Cột 4: Thông tin khác -->
            <div class="space-y-4">
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Khóa học</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">K2022</div>
              </div>
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Tình trạng sinh viên</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">Đang học</div>
              </div>
            </div>
          </div>

          <!-- Section: Thông tin liên lạc -->
          <div class="w-full h-auto min-h-[65px] bg-[#3c8dbc] flex items-center px-4 sm:px-6 py-4 mb-4">
            <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-white">Thông tin liên lạc</span>
          </div>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-6">
            <div>
              <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Số điện thoại</span>
              <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">0859809xxx</div>
            </div>
            <div>
              <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Email sinh viên</span>
              <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1 break-words">A.nguyenvan@hcmut.edu.vn</div>
            </div>
          </div>

          <!-- Section: Nhu cầu hỗ trợ -->
          <div class="w-full h-auto min-h-[65px] bg-[#3c8dbc] flex items-center px-4 sm:px-6 py-4 mb-4">
            <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-white">Nhu cầu hỗ trợ</span>
          </div>

          <div class="mb-6">
            <div class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black mb-2">Nhu cầu</div>
            <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black whitespace-pre-line" id="supportNeedsDisplay">
              <!-- Danh sách sẽ được hiển thị bằng JavaScript -->
            </div>
          </div>

          <!-- Section: Đánh giá và thống kê -->
          <div class="w-full h-auto min-h-[65px] bg-[#3c8dbc] flex items-center px-4 sm:px-6 py-4 mb-4">
            <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-white">Đánh giá và thống kê</span>
          </div>

          <div class="space-y-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
              <div>
                <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Số lần tham gia</span>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">19</div>
              </div>
            </div>
            <div>
              <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Điểm đánh giá trung bình</span>
              <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black mt-1">4.1/5 (19 lượt đánh giá)</div>
            </div>
            <div>
              <span class="font-bold text-[18px] sm:text-[20px] lg:text-[24px] text-black">Nhận xét của Tutor</span>
              <div class="space-y-2 mt-2">
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black">Chăm chỉ - Tutor A</div>
                <div class="font-normal text-[16px] sm:text-[20px] lg:text-[24px] text-black">Hoàn thành tốt - Tutor B</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="bottom-bar">
        <div class="background-3"></div>
        <p class="disclaimer">
          <span class="text-wrapper-37">This is a third party software.<br /></span>
          <span class="text-wrapper-38">All rights belong to Ho Chi Minh University of Technology</span>
        </p>
        <p class="version"><span class="text-wrapper-39">Version </span> <span class="text-wrapper-40">0.1.0</span></p>
      </div>
    </div>

    <!-- Modal Chỉnh sửa thông tin -->
    <div class="modal-overlay" id="editModal">
      <div class="modal-content">
        <div class="modal-title">Chỉnh sửa thông tin</div>
        
        <div class="modal-section">
          <div class="section-title">Nhu cầu hỗ trợ</div>
          <div class="input-group">
            <div class="input-field">
              <label for="supportTitle">Tiêu đề</label>
              <input type="text" id="supportTitle" class="form-input" placeholder="Nhập tiêu đề nhu cầu hỗ trợ" />
            </div>
            <div class="input-field">
              <label for="supportSubject">Môn học</label>
              <div class="autocomplete-wrapper">
                <input type="text" id="supportSubject" class="form-input" placeholder="Nhập hoặc chọn môn học" autocomplete="off" />
                <div class="autocomplete-dropdown" id="subjectDropdown"></div>
              </div>
            </div>
            <button class="btn-add" id="addSupportBtn">Add</button>
          </div>
        </div>

        <div class="modal-section">
          <div class="section-title">Danh sách nhu cầu hỗ trợ</div>
          <div class="support-list" id="supportList">
            <!-- Danh sách sẽ được thêm bằng JavaScript -->
          </div>
        </div>

        <div class="modal-actions">
          <button class="btn-secondary" id="cancelBtn">Hủy</button>
          <button class="btn-secondary" id="saveBtn">Lưu thay đổi</button>
        </div>
      </div>
    </div>

    <script>
      // Danh sách môn học có sẵn
      const subjectsList = [
        'Lập trình Web (CO3049)',
        'Mạng máy tính (CO3093)',
        'Nguyên lý ngôn ngữ lập trình (CO3005)',
        'Tư vấn',
        'Cấu trúc dữ liệu và giải thuật (CO2003)',
        'Cơ sở dữ liệu (CO2010)',
        'Hệ điều hành (CO2007)',
        'Lập trình hướng đối tượng (CO2004)',
        'Toán rời rạc (MA1003)',
        'Xác suất thống kê (MA1004)'
      ];

      // Dữ liệu nhu cầu hỗ trợ hiện tại (từ trang chính)
      let supportNeeds = [
        { title: 'Hướng dẫn thiết kế UI', subject: 'Lập trình Web (CO3049)' },
        { title: 'Ôn cuối kỳ Mạng máy tính', subject: 'Mạng máy tính (CO3093)' },
        { title: 'Hướng dẫn BTL3 PPL', subject: 'Nguyên lý ngôn ngữ lập trình (CO3005)' },
        { title: 'Tư vấn ngành nghệ trong lĩnh vực IT', subject: 'Tư vấn' },
        { title: 'Hướng dẫn BTL3 PPL', subject: 'Nguyên lý ngôn ngữ lập trình (CO3005)' },
        { title: 'Hướng dẫn BTL3 PPL', subject: 'Nguyên lý ngôn ngữ lập trình (CO3005)' }
      ];

      // DOM Elements
      const editModal = document.getElementById('editModal');
      const editInfoBtn = document.getElementById('editInfoBtn');
      const cancelBtn = document.getElementById('cancelBtn');
      const saveBtn = document.getElementById('saveBtn');
      const addSupportBtn = document.getElementById('addSupportBtn');
      const supportTitle = document.getElementById('supportTitle');
      const supportSubject = document.getElementById('supportSubject');
      const subjectDropdown = document.getElementById('subjectDropdown');
      const supportList = document.getElementById('supportList');
      const supportNeedsDisplay = document.getElementById('supportNeedsDisplay');

      // Mở modal
      editInfoBtn.addEventListener('click', () => {
        editModal.style.display = 'flex';
        renderSupportList();
      });

      // Đóng modal
      cancelBtn.addEventListener('click', () => {
        editModal.style.display = 'none';
        resetForm();
      });

      // Đóng modal khi click bên ngoài
      editModal.addEventListener('click', (e) => {
        if (e.target === editModal) {
          editModal.style.display = 'none';
          resetForm();
        }
      });

      // Autocomplete cho môn học
      supportSubject.addEventListener('input', (e) => {
        const value = e.target.value.toLowerCase().trim();
        if (value === '') {
          subjectDropdown.style.display = 'none';
          return;
        }

        const filtered = subjectsList.filter(subject => 
          subject.toLowerCase().includes(value)
        );

        if (filtered.length > 0) {
          subjectDropdown.innerHTML = filtered.map(subject => 
            `<div class="autocomplete-item" data-value="${subject}">${subject}</div>`
          ).join('');
          subjectDropdown.style.display = 'block';
        } else {
          subjectDropdown.style.display = 'none';
        }
      });

      // Chọn môn học từ dropdown
      subjectDropdown.addEventListener('click', (e) => {
        if (e.target.classList.contains('autocomplete-item')) {
          supportSubject.value = e.target.getAttribute('data-value');
          subjectDropdown.style.display = 'none';
        }
      });

      // Ẩn dropdown khi click ra ngoài
      document.addEventListener('click', (e) => {
        const autocompleteWrapper = supportSubject.closest('.autocomplete-wrapper');
        if (!autocompleteWrapper.contains(e.target)) {
          subjectDropdown.style.display = 'none';
        }
      });

      // Thêm nhu cầu hỗ trợ
      addSupportBtn.addEventListener('click', () => {
        const title = supportTitle.value.trim();
        const subject = supportSubject.value.trim();

        if (title === '' || subject === '') {
          alert('Vui lòng nhập đầy đủ tiêu đề và môn học');
          return;
        }

        supportNeeds.push({ title, subject });
        renderSupportList();
        resetForm();
      });


      // Render danh sách nhu cầu hỗ trợ
      function renderSupportList() {
        if (supportNeeds.length === 0) {
          supportList.innerHTML = '<div style="padding: 20px; text-align: center; color: #999;">Chưa có nhu cầu hỗ trợ nào</div>';
          return;
        }

        supportList.innerHTML = supportNeeds.map((item, index) => `
          <div class="support-item">
            <div class="support-item-title">${item.title}</div>
            <div class="support-item-subject">
              <span>${item.subject}</span>
              <button class="btn-delete" data-index="${index}">Delete</button>
            </div>
          </div>
        `).join('');
      }

      // Xử lý xóa bằng event delegation
      supportList.addEventListener('click', (e) => {
        if (e.target.classList.contains('btn-delete')) {
          const index = parseInt(e.target.getAttribute('data-index'));
          supportNeeds.splice(index, 1);
          renderSupportList();
        }
      });

      // Reset form
      function resetForm() {
        supportTitle.value = '';
        supportSubject.value = '';
        subjectDropdown.style.display = 'none';
      }

      // Render danh sách nhu cầu hỗ trợ trên trang chính
      function renderSupportNeedsDisplay() {
        if (supportNeeds.length === 0) {
          supportNeedsDisplay.textContent = 'Chưa có nhu cầu hỗ trợ nào';
          return;
        }

        supportNeedsDisplay.textContent = supportNeeds.map(item => 
          `${item.title} - ${item.subject}`
        ).join('\n\n');
      }

      // Lưu thay đổi
      saveBtn.addEventListener('click', () => {
        // TODO: Gửi dữ liệu lên server
        alert('Đã lưu thay đổi thành công!');
        editModal.style.display = 'none';
        resetForm();
        // Cập nhật lại danh sách trên trang chính
        renderSupportNeedsDisplay();
      });

      // Khởi tạo danh sách ban đầu
      renderSupportList();
      renderSupportNeedsDisplay();
    </script>
  </body>
</html>
